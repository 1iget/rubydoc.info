<style type="text/css" media="screen">
  #top_nav #new_checkout { display: block; }
  #libraries ul { background: #eee; }
  #libraries { list-style: none; }
  #libraries li { line-height: 2em; border-bottom: 1px solid #ddd; }
  #libraries ul li { padding-bottom: 6px; background: #f0f0f0; }
  #libraries ul { padding-bottom: 10px; background: transparent; }
  #libraries li:hover { background: #eef; }
  #libraries li.alternate, #libraries li.alternate:hover { background: transparent; }
  #libraries li a:hover { background: transparent; color: #3ae; }
</style>

<div id="content">
  <ul id="nav">
    <li><a href="/gems">RubyGems</a></li>
    <li class="selected">Github</li>
    <li class="search"><form action="/find/github" method="GET"><input type="text" id="docSearch" name="q" value="<%= @search || 'Search Projects' %>"/></form></li>
  </ul>
  <h2>Github Projects  <%= @search ? 'Search Results' : 'Listing' %> <small>(<a id="framelink" href="#">links without frames</a>)</small></h2>
  <ul class="alpha_index">
    <% (?a..?z).each do |letter| %>
      <% if letter == @letter %>
        <li class="selected"><%= letter.upcase %></li>
      <% else %>
        <li><a href="/github/<%= letter %>"><%= letter.upcase %></a></li>
      <% end %>
    <% end %>
    <li><a href="/github">Latest</a></li>
  </ul>

  <%= erb :checkout, :layout => false %>
  <ul id="libraries">
    <% if @sorted_libraries.size == 0 %>
      <li>No projects match your criteria. You can generate new docs by clicking "Add Project" on top.</li>
    <% end %>
    <% @sorted_libraries.each do |project, repos| %>
      <% next if repos.empty? %>
      <% master = @libraries.master_fork(project) %>
      <li>
        <% username, library_versions = *repos.first %>
        <% if first_lib = library_versions.find {|l| l.name == master } %>
          <% library_versions -= [first_lib] %>
          <a href="/<%= @adapter.router.docs_prefix %>/<%= first_lib %>/frames"><strong><%= username %>/<%= project %></strong></a> 
          <% if first_lib.version %>
            <small>(<%= first_lib.version %><% if library_versions.size > 0 %>, 
              <%= library_versions.reverse[0..2].map {|lib| "<a href=\"/#{@adapter.router.docs_prefix}/#{lib}/frames\">#{lib.version}</a>" }.join(', ') %><% end %>)</small>
          <% end %>
          <% repos.shift %>
        <% else %>
          <strong><%= project %></strong> <small>(No master fork)</small>
        <% end %>
      </li>
      <% next if repos.empty? %>
      <ul class="<%= next_row; next_row %>">
        <li class="alternate"><small>Alternate forks:</small></li>
        <% repos.each do |username, library_versions| %>
          <% next if library_versions.empty? %>
          <li>
            <% library_versions = library_versions.dup %>
            <% first_lib = library_versions.pop %>
            <a href="/<%= @adapter.router.docs_prefix %>/<%= first_lib %>/frames"><%= username %>/<%= project %></a> 
            <% if first_lib.version %>
              <small>(<%= first_lib.version %><% if library_versions.size > 0 %>, 
                <%= library_versions.reverse[0..3].map {|lib| "<a href=\"/#{@adapter.router.docs_prefix}/#{lib}/frames\">#{lib.version}</a>" }.join(', ') %><% end %>)</small>
            <% end %>
          </li>
        <% end %>
      </ul>
    <% end %>
  </ul>
  
</div>

